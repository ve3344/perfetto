{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/plugins/dev.perfetto.BookmarkletApi/index.ts"],"names":[],"mappings":";AAAA,qDAAqD;AACrD,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAYjC,MAAqB,MAAM;IACzB,MAAM,CAAU,EAAE,GAAG,6BAA6B,CAAC;IACnD,MAAM,CAAC,oBAAoB,CAAM;IAEjC,MAAM,CAAC,UAAU,CAAC,SAAc;QAC9B,IAAI,CAAC,oBAAoB,GAAG,SAAS,CAAC;QACtC,MAAM,CAAC,GAAG,GAAG,SAAS,CAAC;IACzB,CAAC;IAED,KAAK,CAAC,WAAW,CAAC,KAAY;QAC5B,MAAM,CAAC,GAAG,GAAG,KAAK,CAAC;QACnB,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE;YACrB,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,oBAAoB,CAAC;QAC3C,CAAC,CAAC,CAAC;IACL,CAAC;;AAdH,yBAeC","sourcesContent":["// Copyright (C) 2024 The Android Open Source Project\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Trace} from '../../public/trace';\nimport {App} from '../../public/app';\nimport {PerfettoPlugin} from '../../public/plugin';\n\ndeclare global {\n  interface Window {\n    ctx: App | Trace | undefined;\n  }\n}\n\nexport default class Plugin implements PerfettoPlugin {\n  static readonly id = 'dev.perfetto.BookmarkletApi';\n  static bookmarkletPluginCtx: App;\n\n  static onActivate(pluginCtx: App): void {\n    this.bookmarkletPluginCtx = pluginCtx;\n    window.ctx = pluginCtx;\n  }\n\n  async onTraceLoad(trace: Trace): Promise<void> {\n    window.ctx = trace;\n    trace.trash.defer(() => {\n      window.ctx = Plugin.bookmarkletPluginCtx;\n    });\n  }\n}\n"]}