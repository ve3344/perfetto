{"version":3,"file":"advanced_settings.js","sourceRoot":"","sources":["../../../../src/plugins/dev.perfetto.RecordTrace/advanced_settings.ts"],"names":[],"mappings":";AAAA,qDAAqD;AACrD,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;;;AAEjC,8DAAwB;AACxB,qDAA2E;AAG3E,MAAM,iBAAiB,GAAG,IAAI,GAAG,EAAkB,CAAC;AACpD,iBAAiB,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;AAC5C,iBAAiB,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;AAC1C,iBAAiB,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AACtC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACxC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACxC,iBAAiB,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AACtC,iBAAiB,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AACtC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACxC,iBAAiB,CAAC,GAAG,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;AACpD,iBAAiB,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AACtC,iBAAiB,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AACtC,iBAAiB,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;AAC1C,iBAAiB,CAAC,GAAG,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;AAClD,iBAAiB,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;AAC1C,iBAAiB,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACxC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACxC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACxC,iBAAiB,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;AAC5C,iBAAiB,CAAC,GAAG,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;AAE9C,MAAa,gBAAgB;IAG3B,IAAI,CAAC,EAAC,KAAK,EAAkC;QAC3C,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC;QAC3C,OAAO,IAAA,iBAAC,EACN,kBAAkB,KAAK,CAAC,QAAQ,EAAE,EAClC,IAAA,iBAAC,EACC,sBAAK,EACL;YACE,KAAK,EAAE,wBAAwB;YAC/B,GAAG,EAAE,gBAAgB;YACrB,KAAK,EAAE;;2CAE0B;YACjC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC;YAC5C,SAAS,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,MAAM;YAC9B,MAAM;SACP,EACD,IAAA,iBAAC,EAAC,uBAAM,EAAE;YACR,KAAK,EAAE,wBAAwB;YAC/B,QAAQ,EAAE,OAAO;YACjB,KAAK,EAAE;;2CAE0B;YACjC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,cAAc,GAAG,GAAG,CAAC;YACpD,SAAS,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,cAAc;YACtC,MAAM;SACP,CAAC,EACF,IAAA,iBAAC,EAAC,uBAAM,EAAE;YACR,KAAK,EAAE,UAAU;YACjB,QAAQ,EAAE,OAAO;YACjB,MAAM,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,GAAG,IAAI,EAAE,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,IAAI,CAAC;YAChE,IAAI,EAAE,IAAI;YACV,aAAa,EAAE,IAAI;YACnB,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,kBAAkB,GAAG,GAAG,CAAC;YACjD,GAAG,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,kBAAkB;YACpC,MAAM;SACP,CAAC,EACF,IAAA,iBAAC,EAAC,uBAAM,EAAE;YACR,KAAK,EAAE,YAAY;YACnB,QAAQ,EAAE,OAAO;YACjB,MAAM,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;YAC5C,IAAI,EAAE,IAAI;YACV,aAAa,EAAE,IAAI;YACnB,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,mBAAmB,GAAG,GAAG,CAAC;YAClD,GAAG,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,mBAAmB;YACrC,MAAM;SACP,CAAC,EACF,IAAA,iBAAC,EAAC,yBAAQ,EAAE;YACV,KAAK,EAAE,cAAc;YACrB,QAAQ,EAAE,4BAA4B;YACtC,OAAO,EAAE,iBAAiB;YAC1B,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,YAAY,GAAG,GAAG,CAAC;YAC3C,GAAG,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,YAAY;YAC9B,MAAM;SACP,CAAC,EACF,IAAA,iBAAC,EAAC,yBAAQ,EAAE;YACV,WAAW,EACT,yCAAyC;gBACzC,sBAAsB;gBACtB,QAAQ;YACV,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,iBAAiB,GAAG,GAAG,CAAC;YAChD,GAAG,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,iBAAiB;YACnC,MAAM;SACP,CAAC,CACH,CACF,CAAC;IACJ,CAAC;CACF;AArED,4CAqEC","sourcesContent":["// Copyright (C) 2022 The Android Open Source Project\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport m from 'mithril';\nimport {Dropdown, Probe, Slider, Textarea, Toggle} from './record_widgets';\nimport {RecordingSectionAttrs} from './recording_sections';\n\nconst FTRACE_CATEGORIES = new Map<string, string>();\nFTRACE_CATEGORIES.set('binder/*', 'binder');\nFTRACE_CATEGORIES.set('block/*', 'block');\nFTRACE_CATEGORIES.set('clk/*', 'clk');\nFTRACE_CATEGORIES.set('ext4/*', 'ext4');\nFTRACE_CATEGORIES.set('f2fs/*', 'f2fs');\nFTRACE_CATEGORIES.set('i2c/*', 'i2c');\nFTRACE_CATEGORIES.set('irq/*', 'irq');\nFTRACE_CATEGORIES.set('kmem/*', 'kmem');\nFTRACE_CATEGORIES.set('memory_bus/*', 'memory_bus');\nFTRACE_CATEGORIES.set('mmc/*', 'mmc');\nFTRACE_CATEGORIES.set('oom/*', 'oom');\nFTRACE_CATEGORIES.set('power/*', 'power');\nFTRACE_CATEGORIES.set('regulator/*', 'regulator');\nFTRACE_CATEGORIES.set('sched/*', 'sched');\nFTRACE_CATEGORIES.set('sync/*', 'sync');\nFTRACE_CATEGORIES.set('task/*', 'task');\nFTRACE_CATEGORIES.set('task/*', 'task');\nFTRACE_CATEGORIES.set('vmscan/*', 'vmscan');\nFTRACE_CATEGORIES.set('fastrpc/*', 'fastrpc');\n\nexport class AdvancedSettings\n  implements m.ClassComponent<RecordingSectionAttrs>\n{\n  view({attrs}: m.CVnode<RecordingSectionAttrs>) {\n    const recCfg = attrs.recState.recordConfig;\n    return m(\n      `.record-section${attrs.cssClass}`,\n      m(\n        Probe,\n        {\n          title: 'Advanced ftrace config',\n          img: 'rec_ftrace.png',\n          descr: `Enable individual events and tune the kernel-tracing (ftrace)\n                  module. The events enabled here are in addition to those from\n                  enabled by other probes.`,\n          setEnabled: (cfg, val) => (cfg.ftrace = val),\n          isEnabled: (cfg) => cfg.ftrace,\n          recCfg,\n        },\n        m(Toggle, {\n          title: 'Resolve kernel symbols',\n          cssClass: '.thin',\n          descr: `Enables lookup via /proc/kallsyms for workqueue,\n              sched_blocked_reason and other events\n              (userdebug/eng builds only).`,\n          setEnabled: (cfg, val) => (cfg.symbolizeKsyms = val),\n          isEnabled: (cfg) => cfg.symbolizeKsyms,\n          recCfg,\n        }),\n        m(Slider, {\n          title: 'Buf size',\n          cssClass: '.thin',\n          values: [0, 512, 1024, 2 * 1024, 4 * 1024, 16 * 1024, 32 * 1024],\n          unit: 'KB',\n          zeroIsDefault: true,\n          set: (cfg, val) => (cfg.ftraceBufferSizeKb = val),\n          get: (cfg) => cfg.ftraceBufferSizeKb,\n          recCfg,\n        }),\n        m(Slider, {\n          title: 'Drain rate',\n          cssClass: '.thin',\n          values: [0, 100, 250, 500, 1000, 2500, 5000],\n          unit: 'ms',\n          zeroIsDefault: true,\n          set: (cfg, val) => (cfg.ftraceDrainPeriodMs = val),\n          get: (cfg) => cfg.ftraceDrainPeriodMs,\n          recCfg,\n        }),\n        m(Dropdown, {\n          title: 'Event groups',\n          cssClass: '.multicolumn.ftrace-events',\n          options: FTRACE_CATEGORIES,\n          set: (cfg, val) => (cfg.ftraceEvents = val),\n          get: (cfg) => cfg.ftraceEvents,\n          recCfg,\n        }),\n        m(Textarea, {\n          placeholder:\n            'Add extra events, one per line, e.g.:\\n' +\n            'sched/sched_switch\\n' +\n            'kmem/*',\n          set: (cfg, val) => (cfg.ftraceExtraEvents = val),\n          get: (cfg) => cfg.ftraceExtraEvents,\n          recCfg,\n        }),\n      ),\n    );\n  }\n}\n"]}