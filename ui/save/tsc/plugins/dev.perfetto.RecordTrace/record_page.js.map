{"version":3,"file":"record_page.js","sourceRoot":"","sources":["../../../../src/plugins/dev.perfetto.RecordTrace/record_page.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (C) 2018 The Android Open Source Project\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport m from 'mithril';\nimport {\n  getDefaultRecordingTargets,\n  hasActiveProbes,\n  isAdbTarget,\n  isAndroidP,\n  isAndroidTarget,\n  isChromeTarget,\n  isCrOSTarget,\n  isLinuxTarget,\n  isWindowsTarget,\n  LoadedConfig,\n  MAX_TIME,\n  RecordingTarget,\n} from './state';\nimport {AdbOverWebUsb} from './adb';\nimport {RECORD_CONFIG_SCHEMA, RecordConfig} from './record_config_types';\nimport {PageAttrs} from '../../public/page';\nimport {\n  autosaveConfigStore,\n  recordConfigStore,\n  recordTargetStore,\n} from './record_config';\nimport {CodeSnippet} from './record_widgets';\nimport {AdvancedSettings} from './advanced_settings';\nimport {AndroidSettings} from './android_settings';\nimport {ChromeSettings} from './chrome_settings';\nimport {CpuSettings} from './cpu_settings';\nimport {GpuSettings} from './gpu_settings';\nimport {LinuxPerfSettings} from './linux_perf_settings';\nimport {MemorySettings} from './memory_settings';\nimport {PowerSettings} from './power_settings';\nimport {RecordingSettings} from './recording_settings';\nimport {EtwSettings} from './etw_settings';\nimport {RecordingManager} from './recording_manager';\nimport {scheduleFullRedraw} from '../../widgets/raf';\nimport {App} from '../../public/app';\nimport {GcsUploader, BUCKET_NAME, MIME_JSON} from '../../base/gcs_uploader';\nimport {showModal} from '../../widgets/modal';\nimport {CopyableLink} from '../../widgets/copyable_link';\n\nexport const RECORDING_SECTIONS = [\n  'buffers',\n  'instructions',\n  'config',\n  'cpu',\n  'etw',\n  'gpu',\n  'power',\n  'memory',\n  'android',\n  'chrome',\n  'tracePerf',\n  'advanced',\n];\n\nfunction RecordHeader(recMgr: RecordingManager) {\n  return m(\n    '.record-header',\n    m(\n      '.top-part',\n      m(\n        '.target-and-status',\n        RecordingPlatformSelection(recMgr),\n        RecordingStatusLabel(recMgr),\n        ErrorLabel(recMgr),\n      ),\n      recordingButtons(recMgr),\n    ),\n    RecordingNotes(recMgr),\n  );\n}\n\nfunction RecordingPlatformSelection(recMgr: RecordingManager) {\n  if (recMgr.state.recordingInProgress) return [];\n\n  const availableAndroidDevices = recMgr.state.availableAdbDevices;\n  const recordingTarget = recMgr.state.recordingTarget;\n\n  const targets = [];\n  for (const {os, name} of getDefaultRecordingTargets()) {\n    targets.push(m('option', {value: os}, name));\n  }\n  for (const d of availableAndroidDevices) {\n    targets.push(m('option', {value: d.serial}, d.name));\n  }\n\n  const selectedIndex = isAdbTarget(recordingTarget)\n    ? targets.findIndex((node) => node.attrs.value === recordingTarget.serial)\n    : targets.findIndex((node) => node.attrs.value === recordingTarget.os);\n\n  return m(\n    '.target',\n    m(\n      'label',\n      'Target platform:',\n      m(\n        'select',\n        {\n          selectedIndex,\n          onchange: (e: Event) => {\n            onTargetChange(recMgr, (e.target as HTMLSelectElement).value);\n          },\n          onupdate: (select) => {\n            // Work around mithril bug\n            // (https://github.com/MithrilJS/mithril.js/issues/2107): We may\n            // update the select's options while also changing the\n            // selectedIndex at the same time. The update of selectedIndex\n            // may be applied before the new options are added to the select\n            // element. Because the new selectedIndex may be outside of the\n            // select's options at that time, we have to reselect the\n            // correct index here after any new children were added.\n            (select.dom as HTMLSelectElement).selectedIndex = selectedIndex;\n          },\n        },\n        ...targets,\n      ),\n    ),\n    m(\n      '.chip',\n      {onclick: () => addAndroidDevice(recMgr)},\n      m('button', 'Add ADB Device'),\n      m('i.material-icons', 'add'),\n    ),\n  );\n}\n\n// |target| can be the TargetOs or the android serial.\nfunction onTargetChange(recMgr: RecordingManager, target: string) {\n  const recordingTarget: RecordingTarget =\n    recMgr.state.availableAdbDevices.find((d) => d.serial === target) ||\n    getDefaultRecordingTargets().find((t) => t.os === target) ||\n    getDefaultRecordingTargets()[0];\n\n  if (isChromeTarget(recordingTarget)) {\n    recMgr.setFetchChromeCategories(true);\n  }\n\n  recMgr.setRecordingTarget(recordingTarget);\n  recordTargetStore.save(target);\n  scheduleFullRedraw();\n}\n\nfunction Instructions(recMgr: RecordingManager, cssClass: string) {\n  return m(\n    `.record-section.instructions${cssClass}`,\n    m('header', 'Recording command'),\n    m(\n      'button.permalinkconfig',\n      {\n        onclick: () => uploadRecordingConfig(recMgr.state.recordConfig),\n      },\n      'Share recording settings',\n    ),\n    RecordingSnippet(recMgr),\n    BufferUsageProgressBar(recMgr),\n    m('.buttons', StopCancelButtons(recMgr)),\n    recordingLog(recMgr),\n  );\n}\n\nexport function loadedConfigEqual(\n  cfg1: LoadedConfig,\n  cfg2: LoadedConfig,\n): boolean {\n  return cfg1.type === 'NAMED' && cfg2.type === 'NAMED'\n    ? cfg1.name === cfg2.name\n    : cfg1.type === cfg2.type;\n}\n\nexport function loadConfigButton(\n  recMgr: RecordingManager,\n  config: RecordConfig,\n  configType: LoadedConfig,\n): m.Vnode {\n  return m(\n    'button',\n    {\n      class: 'config-button',\n      title: 'Apply configuration settings',\n      disabled: loadedConfigEqual(configType, recMgr.state.lastLoadedConfig),\n      onclick: () => {\n        recMgr.setRecordConfig(config, configType);\n        scheduleFullRedraw();\n      },\n    },\n    m('i.material-icons', 'file_upload'),\n  );\n}\n\nexport function displayRecordConfigs(recMgr: RecordingManager) {\n  const configs = [];\n  if (autosaveConfigStore.hasSavedConfig) {\n    configs.push(\n      m('.config', [\n        m('span.title-config', m('strong', 'Latest started recording')),\n        loadConfigButton(recMgr, autosaveConfigStore.get(), {\n          type: 'AUTOMATIC',\n        }),\n      ]),\n    );\n  }\n  for (const item of recordConfigStore.recordConfigs) {\n    configs.push(\n      m('.config', [\n        m('span.title-config', item.title),\n        loadConfigButton(recMgr, item.config, {\n          type: 'NAMED',\n          name: item.title,\n        }),\n        m(\n          'button',\n          {\n            class: 'config-button',\n            title: 'Overwrite configuration with current settings',\n            onclick: () => {\n              if (\n                confirm(\n                  `Overwrite config \"${item.title}\" with current settings?`,\n                )\n              ) {\n                recordConfigStore.overwrite(\n                  recMgr.state.recordConfig,\n                  item.key,\n                );\n                recMgr.setRecordConfig(item.config, {\n                  type: 'NAMED',\n                  name: item.title,\n                });\n                scheduleFullRedraw();\n              }\n            },\n          },\n          m('i.material-icons', 'save'),\n        ),\n        m(\n          'button',\n          {\n            class: 'config-button',\n            title: 'Remove configuration',\n            onclick: () => {\n              recordConfigStore.delete(item.key);\n              scheduleFullRedraw();\n            },\n          },\n          m('i.material-icons', 'delete'),\n        ),\n      ]),\n    );\n  }\n  return configs;\n}\n\nexport const ConfigTitleState = {\n  title: '',\n  getTitle: () => {\n    return ConfigTitleState.title;\n  },\n  setTitle: (value: string) => {\n    ConfigTitleState.title = value;\n  },\n  clearTitle: () => {\n    ConfigTitleState.title = '';\n  },\n};\n\nexport function Configurations(recMgr: RecordingManager, cssClass: string) {\n  const canSave = recordConfigStore.canSave(ConfigTitleState.getTitle());\n  return m(\n    `.record-section${cssClass}`,\n    m('header', 'Save and load configurations'),\n    m('.input-config', [\n      m('input', {\n        value: ConfigTitleState.title,\n        placeholder: 'Title for config',\n        oninput() {\n          ConfigTitleState.setTitle(this.value);\n          scheduleFullRedraw();\n        },\n      }),\n      m(\n        'button',\n        {\n          class: 'config-button',\n          disabled: !canSave,\n          title: canSave\n            ? 'Save current config'\n            : 'Duplicate name, saving disabled',\n          onclick: () => {\n            recordConfigStore.save(\n              recMgr.state.recordConfig,\n              ConfigTitleState.getTitle(),\n            );\n            scheduleFullRedraw();\n            ConfigTitleState.clearTitle();\n          },\n        },\n        m('i.material-icons', 'save'),\n      ),\n      m(\n        'button',\n        {\n          class: 'config-button',\n          title: 'Clear current configuration',\n          onclick: () => {\n            if (\n              confirm(\n                'Current configuration will be cleared. ' + 'Are you sure?',\n              )\n            ) {\n              recMgr.clearRecordConfig();\n              scheduleFullRedraw();\n            }\n          },\n        },\n        m('i.material-icons', 'delete_forever'),\n      ),\n    ]),\n    displayRecordConfigs(recMgr),\n  );\n}\n\nfunction BufferUsageProgressBar(recMgr: RecordingManager) {\n  if (!recMgr.state.recordingInProgress) return [];\n\n  const bufferUsage = recMgr.state.bufferUsage;\n  // Buffer usage is not available yet on Android.\n  if (bufferUsage === 0) return [];\n\n  return m(\n    'label',\n    'Buffer usage: ',\n    m('progress', {max: 100, value: bufferUsage * 100}),\n  );\n}\n\nfunction RecordingNotes(recMgr: RecordingManager) {\n  const sideloadUrl =\n    'https://perfetto.dev/docs/contributing/build-instructions#get-the-code';\n  const linuxUrl = 'https://perfetto.dev/docs/quickstart/linux-tracing';\n  const cmdlineUrl =\n    'https://perfetto.dev/docs/quickstart/android-tracing#perfetto-cmdline';\n  const extensionURL = `https://chrome.google.com/webstore/detail/perfetto-ui/lfmkphfpdbjijhpomgecfikhfohaoine`;\n\n  const notes: m.Children = [];\n\n  const msgFeatNotSupported = m(\n    'span',\n    `Some probes are only supported in Perfetto versions running\n      on Android Q+. `,\n  );\n\n  const msgPerfettoNotSupported = m(\n    'span',\n    `Perfetto is not supported natively before Android P. `,\n  );\n\n  const msgSideload = m(\n    'span',\n    `If you have a rooted device you can `,\n    m(\n      'a',\n      {href: sideloadUrl, target: '_blank'},\n      `sideload the latest version of\n         Perfetto.`,\n    ),\n  );\n\n  const msgRecordingNotSupported = m(\n    '.note',\n    `Recording Perfetto traces from the UI is not supported natively\n     before Android Q. If you are using a P device, please select 'Android P'\n     as the 'Target Platform' and `,\n    m(\n      'a',\n      {href: cmdlineUrl, target: '_blank'},\n      `collect the trace using ADB.`,\n    ),\n  );\n\n  const msgChrome = m(\n    '.note',\n    `To trace Chrome from the Perfetto UI, you need to install our `,\n    m('a', {href: extensionURL, target: '_blank'}, 'Chrome extension'),\n    ' and then reload this page. ',\n  );\n\n  const msgWinEtw = m(\n    '.note',\n    `To trace with Etw on Windows from the Perfetto UI, you to run chrome with`,\n    ` administrator permission and you need to install our `,\n    m('a', {href: extensionURL, target: '_blank'}, 'Chrome extension'),\n    ' and then reload this page.',\n  );\n\n  const msgLinux = m(\n    '.note',\n    `Use this `,\n    m('a', {href: linuxUrl, target: '_blank'}, `quickstart guide`),\n    ` to get started with tracing on Linux.`,\n  );\n\n  const msgLongTraces = m(\n    '.note',\n    `Recording in long trace mode through the UI is not supported. Please copy\n    the command and `,\n    m(\n      'a',\n      {href: cmdlineUrl, target: '_blank'},\n      `collect the trace using ADB.`,\n    ),\n  );\n\n  const msgZeroProbes = m(\n    '.note',\n    \"It looks like you didn't add any probes. \" +\n      'Please add at least one to get a non-empty trace.',\n  );\n\n  if (!hasActiveProbes(recMgr.state.recordConfig)) {\n    notes.push(msgZeroProbes);\n  }\n\n  if (isAdbTarget(recMgr.state.recordingTarget)) {\n    notes.push(msgRecordingNotSupported);\n  }\n  switch (recMgr.state.recordingTarget.os) {\n    case 'Q':\n      break;\n    case 'P':\n      notes.push(m('.note', msgFeatNotSupported, msgSideload));\n      break;\n    case 'O':\n      notes.push(m('.note', msgPerfettoNotSupported, msgSideload));\n      break;\n    case 'L':\n      notes.push(msgLinux);\n      break;\n    case 'C':\n      if (!recMgr.state.extensionInstalled) notes.push(msgChrome);\n      break;\n    case 'CrOS':\n      if (!recMgr.state.extensionInstalled) notes.push(msgChrome);\n      break;\n    case 'Win':\n      if (!recMgr.state.extensionInstalled) notes.push(msgWinEtw);\n      break;\n    default:\n  }\n  if (recMgr.state.recordConfig.mode === 'LONG_TRACE') {\n    notes.unshift(msgLongTraces);\n  }\n\n  return notes.length > 0 ? m('div', notes) : [];\n}\n\nfunction RecordingSnippet(recMgr: RecordingManager) {\n  const target = recMgr.state.recordingTarget;\n\n  // We don't need commands to start tracing on chrome\n  if (isChromeTarget(target)) {\n    return recMgr.state.extensionInstalled && !recMgr.state.recordingInProgress\n      ? m(\n          'div',\n          m(\n            'label',\n            `To trace Chrome from the Perfetto UI you just have to press\n         'Start Recording'.`,\n          ),\n        )\n      : [];\n  }\n  return m(CodeSnippet, {text: getRecordCommand(recMgr, target)});\n}\n\nfunction getRecordCommand(recMgr: RecordingManager, target: RecordingTarget) {\n  const data = recMgr.state.recordCmd;\n\n  const cfg = recMgr.state.recordConfig;\n  let time = cfg.durationMs / 1000;\n\n  if (time > MAX_TIME) {\n    time = MAX_TIME;\n  }\n\n  const pbBase64 = data ? data.pbBase64 : '';\n  const pbtx = data ? data.pbtxt : '';\n  let cmd = '';\n  if (isAndroidP(target)) {\n    cmd += `echo '${pbBase64}' | \\n`;\n    cmd += 'base64 --decode | \\n';\n    cmd += 'adb shell \"perfetto -c - -o /data/misc/perfetto-traces/trace\"\\n';\n  } else {\n    cmd += isAndroidTarget(target)\n      ? 'adb shell perfetto \\\\\\n'\n      : 'perfetto \\\\\\n';\n    cmd += '  -c - --txt \\\\\\n';\n    cmd += '  -o /data/misc/perfetto-traces/trace \\\\\\n';\n    cmd += '<<EOF\\n\\n';\n    cmd += pbtx;\n    cmd += '\\nEOF\\n';\n  }\n  return cmd;\n}\n\nfunction recordingButtons(recMgr: RecordingManager) {\n  const state = recMgr.state;\n  const target = state.recordingTarget;\n  const recInProgress = state.recordingInProgress;\n\n  const start = m(\n    `button`,\n    {\n      class: recInProgress ? '' : 'selected',\n      onclick: () => onStartRecordingPressed(recMgr),\n    },\n    'Start Recording',\n  );\n\n  const buttons: m.Children = [];\n\n  if (isAndroidTarget(target)) {\n    if (\n      !recInProgress &&\n      isAdbTarget(target) &&\n      recMgr.state.recordConfig.mode !== 'LONG_TRACE'\n    ) {\n      buttons.push(start);\n    }\n  } else if (\n    (isWindowsTarget(target) || isChromeTarget(target)) &&\n    state.extensionInstalled\n  ) {\n    buttons.push(start);\n  }\n  return m('.button', buttons);\n}\n\nfunction StopCancelButtons(recMgr: RecordingManager) {\n  if (!recMgr.state.recordingInProgress) return [];\n\n  const stop = m(\n    `button.selected`,\n    {onclick: () => recMgr.stopRecording()},\n    'Stop',\n  );\n\n  const cancel = m(\n    `button`,\n    {onclick: () => recMgr.cancelRecording()},\n    'Cancel',\n  );\n\n  return [stop, cancel];\n}\n\nfunction onStartRecordingPressed(recMgr: RecordingManager) {\n  location.href = '#!/record/instructions';\n  scheduleFullRedraw();\n  autosaveConfigStore.save(recMgr.state.recordConfig);\n\n  const target = recMgr.state.recordingTarget;\n  if (\n    isAndroidTarget(target) ||\n    isChromeTarget(target) ||\n    isWindowsTarget(target)\n  ) {\n    recMgr.app.analytics.logEvent(\n      'Record Trace',\n      `Record trace (${target.os})`,\n    );\n    recMgr.startRecording();\n  }\n}\n\nfunction RecordingStatusLabel(recMgr: RecordingManager) {\n  const recordingStatus = recMgr.state.recordingStatus;\n  if (!recordingStatus) return [];\n  return m('label', recordingStatus);\n}\n\nexport function ErrorLabel(recMgr: RecordingManager) {\n  const lastRecordingError = recMgr.state.lastRecordingError;\n  if (!lastRecordingError) return [];\n  return m('label.error-label', `Error:  ${lastRecordingError}`);\n}\n\nfunction recordingLog(recMgr: RecordingManager) {\n  const logs = recMgr.state.recordingLog;\n  if (logs === undefined) return [];\n  return m('.code-snippet.no-top-bar', m('code', logs));\n}\n\n// The connection must be done in the frontend. After it, the serial ID will\n// be inserted in the state, and the worker will be able to connect to the\n// correct device.\nasync function addAndroidDevice(recMgr: RecordingManager) {\n  let device: USBDevice;\n  try {\n    device = await new AdbOverWebUsb().findDevice();\n  } catch (e) {\n    const err = `No device found: ${e.name}: ${e.message}`;\n    console.error(err, e);\n    alert(err);\n    return;\n  }\n\n  if (!device.serialNumber) {\n    console.error('serial number undefined');\n    return;\n  }\n\n  // After the user has selected a device with the chrome UI, it will be\n  // available when listing all the available device from WebUSB. Therefore,\n  // we update the list of available devices.\n  await recMgr.updateAvailableAdbDevices(device.serialNumber);\n}\n\nfunction recordMenu(recMgr: RecordingManager, routePage: string) {\n  const target = recMgr.state.recordingTarget;\n  const chromeProbe = m(\n    'a[href=\"#!/record/chrome\"]',\n    m(\n      `li${routePage === 'chrome' ? '.active' : ''}`,\n      m('i.material-icons', 'laptop_chromebook'),\n      m('.title', 'Chrome'),\n      m('.sub', 'Chrome traces'),\n    ),\n  );\n  const cpuProbe = m(\n    'a[href=\"#!/record/cpu\"]',\n    m(\n      `li${routePage === 'cpu' ? '.active' : ''}`,\n      m('i.material-icons', 'subtitles'),\n      m('.title', 'CPU'),\n      m('.sub', 'CPU usage, scheduling, wakeups'),\n    ),\n  );\n  const gpuProbe = m(\n    'a[href=\"#!/record/gpu\"]',\n    m(\n      `li${routePage === 'gpu' ? '.active' : ''}`,\n      m('i.material-icons', 'aspect_ratio'),\n      m('.title', 'GPU'),\n      m('.sub', 'GPU frequency, memory'),\n    ),\n  );\n  const powerProbe = m(\n    'a[href=\"#!/record/power\"]',\n    m(\n      `li${routePage === 'power' ? '.active' : ''}`,\n      m('i.material-icons', 'battery_charging_full'),\n      m('.title', 'Power'),\n      m('.sub', 'Battery and other energy counters'),\n    ),\n  );\n  const memoryProbe = m(\n    'a[href=\"#!/record/memory\"]',\n    m(\n      `li${routePage === 'memory' ? '.active' : ''}`,\n      m('i.material-icons', 'memory'),\n      m('.title', 'Memory'),\n      m('.sub', 'Physical mem, VM, LMK'),\n    ),\n  );\n  const androidProbe = m(\n    'a[href=\"#!/record/android\"]',\n    m(\n      `li${routePage === 'android' ? '.active' : ''}`,\n      m('i.material-icons', 'android'),\n      m('.title', 'Android apps & svcs'),\n      m('.sub', 'atrace and logcat'),\n    ),\n  );\n  const advancedProbe = m(\n    'a[href=\"#!/record/advanced\"]',\n    m(\n      `li${routePage === 'advanced' ? '.active' : ''}`,\n      m('i.material-icons', 'settings'),\n      m('.title', 'Advanced settings'),\n      m('.sub', 'Complicated stuff for wizards'),\n    ),\n  );\n  const tracePerfProbe = m(\n    'a[href=\"#!/record/tracePerf\"]',\n    m(\n      `li${routePage === 'tracePerf' ? '.active' : ''}`,\n      m('i.material-icons', 'full_stacked_bar_chart'),\n      m('.title', 'Stack Samples'),\n      m('.sub', 'Lightweight stack polling'),\n    ),\n  );\n  const etwProbe = m(\n    'a[href=\"#!/record/etw\"]',\n    m(\n      `li${routePage === 'etw' ? '.active' : ''}`,\n      m('i.material-icons', 'subtitles'),\n      m('.title', 'ETW Tracing Config'),\n      m('.sub', 'Context switch, Thread state'),\n    ),\n  );\n  const recInProgress = recMgr.state.recordingInProgress;\n\n  const probes = [];\n  if (isLinuxTarget(target)) {\n    probes.push(cpuProbe, powerProbe, memoryProbe, chromeProbe, advancedProbe);\n  } else if (isChromeTarget(target) && !isCrOSTarget(target)) {\n    probes.push(chromeProbe);\n  } else if (isWindowsTarget(target)) {\n    probes.push(chromeProbe, etwProbe);\n  } else {\n    probes.push(\n      cpuProbe,\n      gpuProbe,\n      powerProbe,\n      memoryProbe,\n      androidProbe,\n      chromeProbe,\n      tracePerfProbe,\n      advancedProbe,\n    );\n  }\n\n  return m(\n    '.record-menu',\n    {\n      class: recInProgress ? 'disabled' : '',\n      onclick: () => scheduleFullRedraw(),\n    },\n    m('header', 'Trace config'),\n    m(\n      'ul',\n      m(\n        'a[href=\"#!/record/buffers\"]',\n        m(\n          `li${routePage === 'buffers' ? '.active' : ''}`,\n          m('i.material-icons', 'tune'),\n          m('.title', 'Recording settings'),\n          m('.sub', 'Buffer mode, size and duration'),\n        ),\n      ),\n      m(\n        'a[href=\"#!/record/instructions\"]',\n        m(\n          `li${routePage === 'instructions' ? '.active' : ''}`,\n          m('i.material-icons-filled.rec', 'fiber_manual_record'),\n          m('.title', 'Recording command'),\n          m('.sub', 'Manually record trace'),\n        ),\n      ),\n      m(\n        'a[href=\"#!/record/config\"]',\n        {\n          onclick: () => {\n            recordConfigStore.reloadFromLocalStorage();\n          },\n        },\n        m(\n          `li${routePage === 'config' ? '.active' : ''}`,\n          m('i.material-icons', 'save'),\n          m('.title', 'Saved configs'),\n          m('.sub', 'Manage local configs'),\n        ),\n      ),\n    ),\n    m('header', 'Probes'),\n    m('ul', probes),\n  );\n}\n\nexport function maybeGetActiveCss(routePage: string, section: string): string {\n  return routePage === section ? '.active' : '';\n}\n\nexport interface RecordPageAttrs extends PageAttrs {\n  app: App;\n  recMgr: RecordingManager;\n}\n\nexport class RecordPage implements m.ClassComponent<RecordPageAttrs> {\n  private readonly recMgr: RecordingManager;\n  private lastSubpage: string | undefined = undefined;\n\n  constructor({attrs}: m.CVnode<RecordPageAttrs>) {\n    this.recMgr = attrs.recMgr;\n  }\n\n  oninit({attrs}: m.CVnode<RecordPageAttrs>) {\n    this.lastSubpage = attrs.subpage;\n    if (attrs.subpage !== undefined && attrs.subpage.startsWith('/share/')) {\n      const hash = attrs.subpage.substring(7);\n      loadRecordConfig(this.recMgr, hash);\n      attrs.app.navigate('#!/record/instructions');\n    }\n  }\n\n  view({attrs}: m.CVnode<RecordPageAttrs>) {\n    if (attrs.subpage !== this.lastSubpage) {\n      this.lastSubpage = attrs.subpage;\n      // TODO(primiano): this is a hack necesasry to retrigger the generation of\n      // the record cmdline. Refactor this code once record v1 vs v2 is gone.\n      this.recMgr.setRecordConfig(this.recMgr.state.recordConfig);\n    }\n\n    const pages: m.Children = [];\n    // we need to remove the `/` character from the route\n    let routePage = attrs.subpage ? attrs.subpage.substr(1) : '';\n    if (!RECORDING_SECTIONS.includes(routePage)) {\n      routePage = 'buffers';\n    }\n    pages.push(recordMenu(this.recMgr, routePage));\n\n    pages.push(\n      m(RecordingSettings, {\n        dataSources: [],\n        cssClass: maybeGetActiveCss(routePage, 'buffers'),\n        recState: this.recMgr.state,\n      }),\n    );\n    pages.push(\n      Instructions(this.recMgr, maybeGetActiveCss(routePage, 'instructions')),\n    );\n    pages.push(\n      Configurations(this.recMgr, maybeGetActiveCss(routePage, 'config')),\n    );\n\n    const settingsSections = new Map([\n      ['cpu', CpuSettings],\n      ['gpu', GpuSettings],\n      ['power', PowerSettings],\n      ['memory', MemorySettings],\n      ['android', AndroidSettings],\n      ['chrome', ChromeSettings],\n      ['tracePerf', LinuxPerfSettings],\n      ['advanced', AdvancedSettings],\n      ['etw', EtwSettings],\n    ]);\n    for (const [section, component] of settingsSections.entries()) {\n      pages.push(\n        m(component, {\n          dataSources: [],\n          cssClass: maybeGetActiveCss(routePage, section),\n          recState: this.recMgr.state,\n        }),\n      );\n    }\n\n    if (isChromeTarget(this.recMgr.state.recordingTarget)) {\n      this.recMgr.setFetchChromeCategories(true);\n    }\n\n    return m(\n      '.record-page',\n      this.recMgr.state.recordingInProgress ? m('.hider') : [],\n      m(\n        '.record-container',\n        RecordHeader(this.recMgr),\n        m(\n          '.record-container-content',\n          recordMenu(this.recMgr, routePage),\n          pages,\n        ),\n      ),\n    );\n  }\n}\n\nexport async function uploadRecordingConfig(recordConfig: RecordConfig) {\n  const json = JSON.stringify(recordConfig);\n  const uploader: GcsUploader = new GcsUploader(json, {\n    mimeType: MIME_JSON,\n  });\n  await uploader.waitForCompletion();\n  const hash = uploader.uploadedFileName;\n  const url = `${self.location.origin}/#!/record/share/${hash}`;\n  showModal({\n    title: 'Shareable record settings',\n    content: m(CopyableLink, {url}),\n  });\n}\n\nexport async function loadRecordConfig(recMgr: RecordingManager, hash: string) {\n  const url = `https://storage.googleapis.com/${BUCKET_NAME}/${hash}`;\n  const response = await fetch(url);\n  if (!response.ok) {\n    showModal({title: 'Load failed', content: `Could not fetch ${url}`});\n    return;\n  }\n  const text = await response.text();\n  const json = JSON.parse(text);\n  const res = RECORD_CONFIG_SCHEMA.safeParse(json);\n  if (!res.success) {\n    throw new Error(\n      'Failed to deserialize record settings ' + res.error.toString(),\n    );\n  }\n  recMgr.setRecordConfig(res.data);\n}\n"]}