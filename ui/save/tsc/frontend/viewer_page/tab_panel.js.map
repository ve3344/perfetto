{"version":3,"file":"tab_panel.js","sourceRoot":"","sources":["../../../../src/frontend/viewer_page/tab_panel.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (C) 2024 The Android Open Source Project\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport m from 'mithril';\nimport {TraceImpl} from '../../core/trace_impl';\nimport {Button} from '../../widgets/button';\nimport {MenuItem, PopupMenu2} from '../../widgets/menu';\nimport {Tab, TabbedSplitPanel} from '../../widgets/tabbed_split_panel';\nimport {DEFAULT_DETAILS_CONTENT_HEIGHT} from '../css_constants';\nimport {CurrentSelectionTab} from './current_selection_tab';\n\nexport interface TabPanelAttrs {\n  readonly trace: TraceImpl;\n  readonly className?: string;\n}\n\nexport class TabPanel implements m.ClassComponent<TabPanelAttrs> {\n  view({\n    attrs,\n    children,\n  }: m.Vnode<TabPanelAttrs, this>): m.Children | null | void {\n    const tabs = this.gatherTabs(attrs.trace);\n\n    return m(\n      TabbedSplitPanel,\n      {\n        className: attrs.className,\n        startingHeight: DEFAULT_DETAILS_CONTENT_HEIGHT,\n        leftHandleContent: this.renderDropdownMenu(attrs.trace),\n        tabs,\n        visibility: attrs.trace.tabs.tabPanelVisibility,\n        onVisibilityChange: (visibility) =>\n          attrs.trace.tabs.setTabPanelVisibility(visibility),\n        onTabChange: (key) => attrs.trace.tabs.showTab(key),\n        currentTabKey: attrs.trace.tabs.currentTabUri,\n      },\n      children,\n    );\n  }\n\n  private gatherTabs(trace: TraceImpl) {\n    const tabMan = trace.tabs;\n    const tabList = trace.tabs.openTabsUri;\n    const resolvedTabs = tabMan.resolveTabs(tabList);\n\n    const tabs = resolvedTabs.map(({uri, tab: tabDesc}): Tab => {\n      if (tabDesc) {\n        return {\n          key: uri,\n          hasCloseButton: true,\n          title: tabDesc.content.getTitle(),\n          content: tabDesc.content.render(),\n          onClose: () => {\n            trace.tabs.hideTab(uri);\n          },\n        };\n      } else {\n        return {\n          key: uri,\n          hasCloseButton: true,\n          title: 'Tab does not exist',\n          content: undefined,\n        };\n      }\n    });\n\n    // Add the permanent current selection tab to the front of the list of tabs\n    tabs.unshift({\n      key: 'current_selection',\n      title: 'Current Selection',\n      content: m(CurrentSelectionTab, {trace}),\n    });\n\n    return tabs;\n  }\n\n  private renderDropdownMenu(trace: TraceImpl): m.Child {\n    const entries = trace.tabs.tabs\n      .filter((tab) => tab.isEphemeral === false)\n      .map(({content, uri}) => {\n        return {\n          key: uri,\n          title: content.getTitle(),\n          onClick: () => trace.tabs.toggleTab(uri),\n          checked: trace.tabs.isOpen(uri),\n        };\n      });\n\n    return m(\n      PopupMenu2,\n      {\n        trigger: m(Button, {\n          compact: true,\n          icon: 'more_vert',\n          disabled: entries.length === 0,\n          title: 'More Tabs',\n        }),\n      },\n      entries.map((entry) => {\n        return m(MenuItem, {\n          key: entry.key,\n          label: entry.title,\n          onclick: () => entry.onClick(),\n          icon: entry.checked ? 'check_box' : 'check_box_outline_blank',\n        });\n      }),\n    );\n  }\n}\n"]}