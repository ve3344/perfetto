{"version":3,"file":"pivot_table_tree_builder_unittest.js","sourceRoot":"","sources":["../../../src/core/pivot_table_tree_builder_unittest.ts"],"names":[],"mappings":";AAAA,qDAAqD;AACrD,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;AAEjC,+DAA4D;AAE5D,QAAQ,CAAC,0BAA0B,EAAE,GAAG,EAAE;IACxC,IAAI,CAAC,+BAA+B,EAAE,GAAG,EAAE;QACzC,MAAM,OAAO,GAAG,IAAI,2CAAqB,CACvC;YACE,YAAY,EAAE;gBACZ,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,UAAU,EAAC;gBACrD,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAC;aAClD;YACD,kBAAkB,EAAE;gBAClB;oBACE,mBAAmB,EAAE,KAAK;oBAC1B,MAAM,EAAE,EAAC,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,EAAC;iBACzD;aACF;YACD,UAAU,EAAE,CAAC;SACd,EACD,CAAC,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAC3B,CAAC;QAEF,OAAO,CAAC,SAAS,CAAC,CAAC,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;QAC9C,OAAO,CAAC,SAAS,CAAC,CAAC,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;QAE9C,sEAAsE;QACtE,wEAAwE;QACxE,2CAA2C;QAC3C,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;IAC1D,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright (C) 2023 The Android Open Source Project\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {PivotTableTreeBuilder} from './pivot_table_manager';\n\ndescribe('Pivot Table tree builder', () => {\n  test('aggregates averages correctly', () => {\n    const builder = new PivotTableTreeBuilder(\n      {\n        pivotColumns: [\n          {kind: 'regular', table: 'slice', column: 'category'},\n          {kind: 'regular', table: 'slice', column: 'name'},\n        ],\n        aggregationColumns: [\n          {\n            aggregationFunction: 'AVG',\n            column: {kind: 'regular', table: 'slice', column: 'dur'},\n          },\n        ],\n        countIndex: 1,\n      },\n      ['cat1', 'name1', 80.0, 2],\n    );\n\n    builder.ingestRow(['cat1', 'name2', 20.0, 1]);\n    builder.ingestRow(['cat2', 'name3', 20.0, 1]);\n\n    // With two rows of average value 80.0, and two of average value 20.0;\n    // the total sum is 80.0 * 2 + 20.0 + 20.0 = 200.0 over four slices. The\n    // average value should be 200.0 / 4 = 50.0\n    expect(builder.build().aggregates[0]).toBeCloseTo(50.0);\n  });\n});\n"]}